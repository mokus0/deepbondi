#!/bin/sh
#
#  <mk_obsd_iso>
#    Copyright 2002 James Cook - All Rights Reserved.
#

downloadDir=/home/Shared/OpenBSD
if [ -d /Users/Shared/OpenBSD ]; then
	downloadDir=/Users/Shared/OpenBSD
fi

version=${1:-`ls $downloadDir | grep -e '^[0-9]\.[0-9]$' | tail -n1`}
svers=`/bin/echo -n ${version} | sed 's/\.//'`

echo "Using version ${version} (svers=${svers})"

if [ -d $version/i386 ]; then
	echo Hmm... Ok...
	cd=""
elif [ -d "$downloadDir/$version/i386" ]; then
	echo Good Enough...
	cd="$downloadDir"
else
	echo Go somewhere else.  Read the script if you have to.
	exit
fi

echo Making obsd${version}.iso in 3 seconds...
sleep 3

bootfile="$version/i386/cdrom${svers}.fs"

mkisofs -vrTJV "OpenBSD ${version}" -b $bootfile -c boot.catalog -o obsd${version}.iso -graft-points /${version}/=${cd}/${version}
